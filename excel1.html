<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>无标题文档</title>
</head>

<body>
<script language="javascript">
$ bower install tableexport.js
$ npm install tableexport    
</script>

<SCRIPT LANGUAGE="javascript"> 
function dataToExcel(tableid) {//整个表格拷贝到EXCEL中  
var curTbl = document.getElementById(tableid);   
var oXL;   
try {   
oXL = GetObject("", "Excel.Application");   
}   
catch (E) {   
try {   
oXL = new ActiveXObject("Excel.Application"); 
  
}   
catch (E2) {   
//alert("Please confirm:\n1.Microsoft Excel has been installed.\n2.Internet   
  
alert("请确认1.机器上Excel已经安装.\n2.Internet 选项=>安全=>Internet 对未标记为安全的ActiveX控件进行初始化和脚本运行设定为启用");  
return;   
}   
}  
//创建AX对象excel   
var oWB = oXL.Workbooks.Add(); 
alert('a')   
//获取workbook对象   
var oSheet = oWB.ActiveSheet;   
//激活当前sheet   
var sel = document.body.createTextRange();   
sel.moveToElementText(curTbl);   
//把表格中的内容移到TextRange中   
sel.select();
  
//全选TextRange中内容   
sel.execCommand("Copy");   
//复制TextRange中内容   
oSheet.Paste();   
//粘贴到活动的EXCEL中   
oXL.Visible = true;   
//设置excel可见属性   
}  
<!-- 
function AutomateExcel() 
{ 
// Start Excel and get Application object. 
var oXL = new ActiveXObject("Excel.Application"); 
// Get a new workbook. 
var oWB = oXL.Workbooks.Add(); 
var oSheet = oWB.ActiveSheet; 
var table = document.all.data; 
var hang = table.rows.length;
 
var lie = table.rows(0).cells.length;
 
// Add table headers going cell by cell. 
for (i=0;i<hang;i++) 
{ 
for (j=0;j<lie;j++) 
{ 
//oSheet.Cells(i+1,j+1).Font.Bold = True 
//oSheet.Cells(i+1,j+1).Font.Size = 50 
//oSheet.Cells(i+1,j+1).Alignment = 2
oSheet.Cells(i+1,j+1).value = table.rows(i).cells(j).innerText; 
}
 
} 
oXL.Visible = true; 
oXL.UserControl = true; 
} 
//-->
/*
var idTmr;  
        function method1(tableid) {//整个表格拷贝到EXCEL中  
            var curTbl = document.getElementById(tableid);  
            var oXL = new ActiveXObject("Excel.Application");  
            //创建AX对象excel   
            var oWB = oXL.Workbooks.Add();  
            //获取workbook对象   
            var xlsheet = oWB.Worksheets(1);  
            //激活当前sheet   
            var sel = document.body.createTextRange();  
            sel.moveToElementText(curTbl);  
            //把表格中的内容移到TextRange中   
            sel.select();  
            //全选TextRange中内容   
            sel.execCommand("Copy");  
            //复制TextRange中内容    
            xlsheet.Paste();  
            //粘贴到活动的EXCEL中         
            oXL.Visible = true;  
            //设置excel可见属性  
  
            try {  
                var fname = oXL.Application.GetSaveAsFilename("将Table导出到Excel.xls", "Excel Spreadsheets (*.xls), *.xls");  
            } catch (e) {  
                print("Nested catch caught " + e);  
            } finally {  
                oWB.SaveAs(fname);  
  
                oWB.Close(savechanges = false);  
                //xls.visible = false;  
                oXL.Quit();  
                oXL = null;  
                //结束excel进程，退出完成  
                //window.setInterval("Cleanup();",1);  
                idTmr = window.setInterval("Cleanup();", 1);  
  
            }  
        }  
        function Cleanup() {  
            window.clearInterval(idTmr);  
            CollectGarbage();  
        } */ 
</SCRIPT>
<input type="button" name="out_excel" onclick="AutomateExcel()" value="导出到excel" class="notPrint">
	
<table border="1" width="100%" id="data">
<tr>
<td> 姓名</td>
<td colspan="2">年龄</td>
<td>出生日期</td>
</tr>
<tr>
<td>6</td>
<td>25</td>
<td colspan="2">8</td>
</tr>
<tr>
<td height="22">1</td>
<td height="22">2</td>
<td colspan="2" height="22">4</td>
</tr>
</table>
</body>
</html>
